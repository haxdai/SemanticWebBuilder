<?xml version="1.0" encoding="ISO-8859-1"?>
<admresource xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <xslfile>admresource.xslt</xslfile>
    <form name="frmAddNew" action="true" method="POST" enctype="multipart/form-data" jsframework="dojo" >
        <admdbconnmgr defconn="true"/>
        <fieldset legend="Datos">
            <input type="text" name="title" label="Título:" maxlength="60" promptMessage="Título" />
            <input type="text" name="level" label="Nivel de despliegue" value="1" maxlength="3" jsvaltype="js_numbers" invalidMessage="Nivel debe ser un valor numérico" promptMessage="Nivel de despliegue" />
            <input type="text" name="url" label="Sección que despliega el mapa de sitio:" maxlength="50" jsrequired="true" regExp="^[a-zA-Z0-9_]+" promptMessage="Identificador de la sección que despliega el mapa de sitio" invalidMessage="Identificador de sección inválido" />

            <fieldset legend="Modo">
                <statictext name="txtTarget">¿Cómo desea acceder al recurso de mapa de sitio?:</statictext>
                <input type="text" name="lnktexto" label="Texto de la liga:" maxlength="50" promptMessage="Texto de la liga" />
                <input type="text" name="btntexto" label="Etiqueta del botón:" maxlength="50" promptMessage="Etiqueta del botón" />
                <input type="file" name="img" label="Imagen (gif, jpg, jpeg, png):" showfile="true" filetype="jpg|jpeg|gif|png" isshowfiletype="true" isremovefile="true" removemsg="Quitar imagen" />
                <input type="text" name="alt" label="Texto alterno:" maxlength="50" promptMessage="Texto alterno para la imagen. Pauta de accesibilidad" />
            </fieldset>

            <statictext name="note">
            <![CDATA[
                <font style="color: #428AD4; font-family: Verdana; font-size:10px;">
                * Dato requerido
                </font>
            ]]>
            </statictext>
        </fieldset>

        <fieldset>
            <statictext name="cmd">
            <![CDATA[
            <button id="btnSave" type="submit" dojoType="dijit.form.Button">Guardar</button>
            <button id="btnReset" type="reset" dojoType="dijit.form.Button" type="reset">Reestablecer</button>
            ]]>
            </statictext>
        </fieldset>
    </form>

    <script type="text/javascript">
        <![CDATA[
        dojo.require("dijit.form.Button");

        dojo.addOnLoad(
            function(){
                dojo.connect(dijit.byId("btnSave"), "onSubmit",
                    function() {
                        if( jsValida(dojo.byId("frmAddNew")) )
                            return true;
                        else
                            return false;
                    }
                );
            }
        );

        function jsValida(frm) {
            if( !frm.lnktexto.value && !frm.btntexto.value && !frm.img.value  && !dojo.byId('wbNoFile_img') ) {
                alert('Indique el mecanismo para acceder al recurso de mapa de sitio.');
                frm.lnktexto.focus();
                return false;
            }
            if( frm.img.value && !frm.alt.value ) {
                alert('Indique el texto alterno para la imagen.');
                frm.alt.focus();
                return false;
            }
            return true;
        }
        ]]>
    </script>
</admresource>